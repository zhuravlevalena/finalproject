{"version":3,"file":"enterCropMode.mjs","sources":["../../extensions/cropping_controls/enterCropMode.ts"],"sourcesContent":["import { type FabricImage, type TPointerEventInfo } from 'fabric';\nimport { createImageCroppingControls } from './croppingControls';\nimport { cropPanMoveHandler } from './croppingHandlers';\n/**\n * Coordinates the change to image to enter crop mode and returns\n * a function to exit crop mode\n */\nexport const enterCropMode = function enterCropMode(\n  this: (args: TPointerEventInfo) => void,\n  { target }: TPointerEventInfo,\n) {\n  const fabricImage = target as FabricImage;\n  const { controls } = fabricImage;\n  fabricImage.controls = createImageCroppingControls();\n  fabricImage.on('moving', cropPanMoveHandler);\n  fabricImage.setCoords();\n  const exitCropMode = () => {\n    fabricImage.off('moving', cropPanMoveHandler);\n    fabricImage.controls = controls;\n    fabricImage.setCoords();\n    fabricImage.once('mousedblclick', enterCropMode);\n    fabricImage.canvas?.requestRenderAll();\n  };\n  fabricImage.once('mousedblclick', exitCropMode);\n  fabricImage.canvas?.requestRenderAll();\n};\n"],"names":["enterCropMode","_ref","_fabricImage$canvas2","target","fabricImage","controls","createImageCroppingControls","on","cropPanMoveHandler","setCoords","exitCropMode","_fabricImage$canvas","off","once","canvas","requestRenderAll"],"mappings":";;;AAGA;AACA;AACA;AACA;MACaA,aAAa,GAAG,SAASA,aAAaA,CAAAC,IAAA,EAGjD;AAAA,EAAA,IAAAC,oBAAA;EAAA,IADA;AAAEC,IAAAA;AAA0B,GAAC,GAAAF,IAAA;EAE7B,MAAMG,WAAW,GAAGD,MAAqB;EACzC,MAAM;AAAEE,IAAAA;AAAS,GAAC,GAAGD,WAAW;AAChCA,EAAAA,WAAW,CAACC,QAAQ,GAAGC,2BAA2B,EAAE;AACpDF,EAAAA,WAAW,CAACG,EAAE,CAAC,QAAQ,EAAEC,kBAAkB,CAAC;EAC5CJ,WAAW,CAACK,SAAS,EAAE;EACvB,MAAMC,YAAY,GAAGA,MAAM;AAAA,IAAA,IAAAC,mBAAA;AACzBP,IAAAA,WAAW,CAACQ,GAAG,CAAC,QAAQ,EAAEJ,kBAAkB,CAAC;IAC7CJ,WAAW,CAACC,QAAQ,GAAGA,QAAQ;IAC/BD,WAAW,CAACK,SAAS,EAAE;AACvBL,IAAAA,WAAW,CAACS,IAAI,CAAC,eAAe,EAAEb,aAAa,CAAC;AAChD,IAAA,CAAAW,mBAAA,GAAAP,WAAW,CAACU,MAAM,MAAA,IAAA,IAAAH,mBAAA,KAAA,MAAA,IAAlBA,mBAAA,CAAoBI,gBAAgB,EAAE;EACxC,CAAC;AACDX,EAAAA,WAAW,CAACS,IAAI,CAAC,eAAe,EAAEH,YAAY,CAAC;AAC/C,EAAA,CAAAR,oBAAA,GAAAE,WAAW,CAACU,MAAM,MAAA,IAAA,IAAAZ,oBAAA,KAAA,MAAA,IAAlBA,oBAAA,CAAoBa,gBAAgB,EAAE;AACxC;;;;"}